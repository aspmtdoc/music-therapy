<!DOCTYPE html>
{% load staticfiles %}
{% load template_getattr %}
<html>

<head>
    {% include "musictherapy/component/header.html" %}
</head>
<body>
    <div class="page">
        <div class="inner">
            <div>
                <div class="col-md-10">
                    <h1>Program: {{ program.name }}</h1>
                </div>
                <div class="cold-md-2">
                    <a class="btn btn-info pull-left" href="{% url 'musictherapy:list' %}" style="margin:5px">Home</a>
                </div>
                <div class="col-md-12">
                    <div class="col-md-4">
                        <h3>{{ program.location }}</h3>
                    </div>
                    <div class="col-md-4">
                        <h3>{{ program.get_date_display }}</h3>
                    </div>
                    <div class="col-md-4">
                        <h3>{{ program.get_day_of_week_display }}</h3>
                    </div>
                </div>
            </div>
            <div>
                {% include "musictherapy/user_list.html" with user_list=users redirect="program"%}
            </div>
            <div>
            {% for user in users %}
                {% with session=sessions|getattrib:user.id %}
                <div class="panel-group" id="accordion-gm-{{user.id}}">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4 class="panel-title">
                                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion-gm-{{user.id}}" href="#gm-{{user.id}}" aria-expanded="true">{{user.name}} - Session: {{session.date.date}}</a>
                            </h4>
                        </div>
                        <div id="gm-{{user.id}}" class="panel-collapse collapse in" aria-expanded="true">
                            <div class="panel-body">
                                {% with session_form=forms|getattrib:user.id %}
                                    <div class="row">
                                        {% if session.status == 0 %}
                                            <div class="col-md-6"><h4 style="color: red; padding-bottom: 10px; padding-top: 10px;">Session Missed</h4></div>
                                            <div class="col-md-6">
                                        {% else %}
                                            <div class="col-md-6 col-md-offset-6">
                                        {% endif %}
                                            <a class="btn btn-info pull-right" href="" style="margin: 5px" data-toggle="modal" data-target="#session-{{session.id}}-status-modal">Mark as Absent</a>
                                        </div>
                                    </div>
                                    {% include "musictherapy/component/mark_as_absent.html" with session_form=session_form session=session user=user%}
                                {% endwith %}

                                <div class="row">
                                    <div class="col-md-12">
                                        {% include "musictherapy/component/session_goals.html" with data=data|getattrib:user.id user=user session=sessions|getattrib:user.id%}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% endwith %}
            {% endfor %}
            </div>
        </div>
    </div>
</body>
</html>
