{% extends "easy_pdf/base.html" %}
{% load template_getattr %}

{% block layout_style %}
    <style type="text/css">
        @page {
            size: {{ pagesize|default:"A4" }};
            margin-left: 2.5cm;
            margin-right: 2.5cm;
            margin-top: 3cm;
            margin-bottom: 2cm;

            @frame header {
                -pdf-frame-content: page-header;
                margin-top: 1.2cm;
                margin-right: 1.2cm;
                margin-bottom: 1.2cm;
                margin-left: 1.2cm;
            }
        }
    </style>
{% endblock %}

{% block extra_style %}
    <style type="text/css">
        .tab {
            margin: 0 0 0 40px;
        }

        .double-tab {
            margin: 0 0 0 60px;
        }

        .right-space {
            margin: 0 10px 0 0;
        }

        .signature-border {
            border-top: solid;
            border-color: black;
            padding-top: 0.5cm;
        }

        .right {
            text-align: right;
        }

        #signature {
            margin-top: 1cm;
        }
    </style>
{% endblock %}

{% block page_header %}
<div id="page-header">
    <div class="header">
        <div class="tab">
            <b>Name: {{userinfo.name}}</b><br/>
            <b>Programs:
            {% for program in programs %}
                {{program}};
            {% endfor %}
            </b>
        </div>
    </div>
</div>
{% endblock %}


{% block content %}
    <div id="content">
        <div class="main">
            <h1 style="text-align:center">Alzhemier Society Peel's Music Therapy Treatment Plan</h1>

            {{ context }}

            <div id="treatment-plan">
                {% if general_goals %}
                <h1>General Goals</h1>
                <div>
                    <p class="tab">
                        {% for goal in general_goals %}
                            {{ goal.goal.name }}<br/>
                        {% endfor %}
                    </p>
                </div>
                {% endif %}


                {% for domain, domain_data in goals.items %}
                <h1>{{ domain }} Goals</h1>
                    {% for goal, user_goal_measurables in domain_data.items %}
                    <div>
                        <h3 class="tab">{{ goal.name }}</h3>
                            <p class="double-tab">
                                {% for ugm in user_goal_measurables %}
                                {{ ugm.goal_measurable.name }}: {{ugm.get_value_display}}<br/>
                                {% endfor %}
                            </p>

                        {% with note=notes|getattrib:domain%}
                        {% if note %}
                            <h4>Notes:</h4>
                                <p class="double-tab">
                                    {{note}}
                                </p>
                        {% endif %}
                        {% endwith %}
                    </div>
                    {% endfor %}
                {% endfor %}
            </div>


            <div id="signature">
                <h3 class="signature-border">Music Therapist Signature:</h3>
                <p class="right">Date: {{ date }}</p>
            </div>
        </div>
    </div>
{% endblock %}}